<!DOCTYPE html>
<!-- saved from url=(0057)http://www.seas.upenn.edu/~cis391/Homework/homework5.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <title>Homework 5</title>
        <link rel="stylesheet" type="text/css" href="./Homework 5_files/homework.css">
        <link rel="stylesheet" type="text/css" href="./Homework 5_files/prism.css">
        <script type="text/javascript" src="./Homework 5_files/prism.js"></script>
        <script type="text/javascript" src="./Homework 5_files/MathJax.js"></script>
        <script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
        <style>
            table.probability {
                text-align: center;
                border: 1px solid black;
                margin: auto;
            }
            table.probability td {
                padding-left: 10px;
                padding-right: 10px;
            }
            table.probability tr:first-child {
                border: 1px solid black;
            }
            table.probability td:last-child {
                border-left: 1px solid black;
            }
        </style>
    <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body style="zoom: 1;"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
        <div class="content language-markup">
            <h1>CIS 391: Homework 5<span class="points" data-value="100"></span></h1>
            <table class="dates">
                <tbody><tr>
                    <td>Release Date</td>
                    <td>Thursday, October 22, 2015</td>
                </tr>
                <tr>
                    <td>Due Date</td>
                    <td>11:59 pm on Thursday, October 29, 2015</td>
                </tr>
            </tbody></table>
            <section>
                <h3>Instructions</h3>
                <p>In this assignment, you will implement a basic spam filter using naive Bayes classification.</p>
                <p>A skeleton file <code class=" language-markup">homework5.py</code> containing empty definitions for each question has been provided. Since portions of this assignment will be graded automatically, none of the names or function signatures in this file should be modified. However, you are free to introduce additional variables or functions if needed.</p>
                <p>You may import definitions from any standard Python library, and are encouraged to do so in case you find yourself reinventing the wheel. If you are unsure where to start, consider taking a look at the data structures and functions defined in the <code class=" language-markup">collections</code>, <code class=" language-markup">email</code>, <code class=" language-markup">math</code>, and <code class=" language-markup">os</code> modules.</p>
                <p>You will find that in addition to a problem specification, most programming questions also include one or two examples from the Python interpreter. In addition to performing your own testing, you are strongly encouraged to verify that your code gives the expected output for these examples before submitting.</p>
                <p>It is highly recommended that you follow the Python style guidelines set forth in <a href="http://legacy.python.org/dev/peps/pep-0008/">PEP 8</a>, which was written in part by the creator of Python. However, your code will not be graded for style.</p>
                <p>Once you have completed the assignment, you should submit your file on Eniac using the following <code class=" language-markup">turnin</code> command, where the flags <code class=" language-markup">-c</code> and <code class=" language-markup">-p</code> stand for "course" and "project", respectively.</p>
                <pre class=" language-markup"><code class=" language-markup">turnin -c cis391 -p hw5 homework5.py</code></pre>
                <p>You may submit as many times as you would like before the deadline, but only the last submission will be saved. To view a detailed listing of the contents of your most recent submission, you can use the following command, where the flag <code class=" language-markup">-v</code> stands for "verbose".</p>
                <pre class=" language-markup"><code class=" language-markup">turnin -c cis391 -p hw5 -v</code></pre>
            </section>
            <section class="numbered">
                <h3>Spam Filter<span class="points" data-value="95"></span></h3>
                <p>In this section, you will implement a minimal system for spam filtering. You will begin by processing the raw training data, which is assumed in the examples below to lie in the directory <code class=" language-markup">data/train</code> relative to the skeleton file. Next, you will proceed by estimating the conditional probability distributions of the words in the vocabulary determined by each document class. Lastly, you will use a naive Bayes model to make predictions on the publicly available test set, located in <code class=" language-markup">data/dev</code>.</p>
                <ol>
                    <li>
                        <p><span class="points" data-value="5"></span>Making use of the <code class=" language-python">email</code> module, write a function <code class=" language-python">load_tokens<span class="token punctuation">(</span>email_path<span class="token punctuation">)</span></code> that reads the email at the specified path, extracts the tokens from its message, and returns them as a list.</p>
                        <p>Specifically, you should use the <code class=" language-python">email<span class="token punctuation">.</span>message_from_file<span class="token punctuation">(</span>file_obj<span class="token punctuation">)</span></code> function to create a <code class=" language-python">message</code> object from the contents of the file, and the <code class=" language-python">email<span class="token punctuation">.</span>iterators<span class="token punctuation">.</span>body_line_iterator<span class="token punctuation">(</span>message<span class="token punctuation">)</span></code> function to iterate over the lines in the message. Here, tokens are considered to be contiguous substrings of non-whitespace characters.</p>
                        <table class="codeGroup">
                            <tbody><tr>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> ham_dir <span class="token operator">=</span> <span class="token string">"data/train/ham/"</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> load_tokens<span class="token punctuation">(</span>ham_dir<span class="token operator">+</span><span class="token string">"ham1"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">:</span><span class="token number">204</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token string">'of'</span><span class="token punctuation">,</span> <span class="token string">'my'</span><span class="token punctuation">,</span> <span class="token string">'outstanding'</span><span class="token punctuation">,</span> <span class="token string">'mail'</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> load_tokens<span class="token punctuation">(</span>ham_dir<span class="token operator">+</span><span class="token string">"ham2"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">:</span><span class="token number">114</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token string">'for'</span><span class="token punctuation">,</span> <span class="token string">'Preferences'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">"didn't"</span><span class="token punctuation">]</span>
</code></pre>
                                </td>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> spam_dir <span class="token operator">=</span> <span class="token string">"data/train/spam/"</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> load_tokens<span class="token punctuation">(</span>spam_dir<span class="token operator">+</span><span class="token string">"spam1"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token string">'You'</span><span class="token punctuation">,</span> <span class="token string">'are'</span><span class="token punctuation">,</span> <span class="token string">'receiving'</span><span class="token punctuation">,</span> <span class="token string">'this'</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> load_tokens<span class="token punctuation">(</span>spam_dir<span class="token operator">+</span><span class="token string">"spam2"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token string">'&lt;html&gt;'</span><span class="token punctuation">,</span> <span class="token string">'&lt;body&gt;'</span><span class="token punctuation">,</span> <span class="token string">'&lt;center&gt;'</span><span class="token punctuation">,</span> <span class="token string">'&lt;h3&gt;'</span><span class="token punctuation">]</span>
</code></pre>
                                </td>
                            </tr>
                        </tbody></table>
                    </li>
                    <li>
                        <p><span class="points" data-value="20"></span>Write a function <code class=" language-python">log_probs<span class="token punctuation">(</span>email_paths<span class="token punctuation">,</span> smoothing<span class="token punctuation">)</span></code> that returns a dictionary from the words contained in the given emails to their Laplace-smoothed log-probabilities. Specifically, if the set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame"><nobr><span class="math" id="MathJax-Span-1" role="math" style="width: 0.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.706em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.878em; vertical-align: -0.059em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">V</script> denotes the vocabulary of words in the emails, then the probabilities should be computed by taking the logarithms of
                            <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-4" role="math" style="width: 42.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 37.953em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.453em 1000em 3.325em -999.997em); top: -2.137em; left: 0.003em;"><span class="mrow" id="MathJax-Span-5"><span class="mtable" id="MathJax-Span-6" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 37.615em; height: 0px;"><span style="position: absolute; clip: rect(2.987em 1000em 4.169em -999.997em); top: -3.995em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000em 4.338em -999.997em); top: -4.164em; right: 0.003em;"><span class="mtd" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-10" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-11" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-12" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.311em 1000em 5.183em -999.997em); top: -3.995em; left: 1.974em;"><span style="display: inline-block; position: relative; width: 14.699em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1000em 5.408em -999.997em); top: -4.164em; left: 0.003em;"><span class="mtd" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15"></span><span class="mo" id="MathJax-Span-16" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">=</span><span class="mfrac" id="MathJax-Span-17" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 12.841em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1000em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -2.644em;"><span class="mrow" id="MathJax-Span-18"><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular;">c</span><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular;">o</span><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">u</span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular;">n</span><span class="mi" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-28" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-29" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Italic; padding-left: 0.228em;">α</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.987em 1000em 4.507em -999.997em); top: -3.15em; left: 50%; margin-left: -6.36em;"><span class="mrow" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mo" id="MathJax-Span-33" style="vertical-align: -0.222em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="munderover" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 2.649em; height: 0px;"><span style="position: absolute; clip: rect(3.043em 1000em 4.451em -999.997em); top: -3.995em; left: 0.003em;"><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.713em; left: 0.904em;"><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="msup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px;"><span style="position: absolute; clip: rect(3.494em 1000em 4.169em -999.997em); top: -3.995em; left: 0.003em;"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.22em; left: 0.453em;"><span class="mo" id="MathJax-Span-40" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-43" style="padding-left: 0.172em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral-Regular;">c</span><span class="mi" id="MathJax-Span-46" style="font-family: STIXGeneral-Regular;">o</span><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular;">u</span><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular;">n</span><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral-Regular;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-50" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000em 4.169em -999.997em); top: -3.995em; left: 0.003em;"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.276em; left: 0.678em;"><span class="mo" id="MathJax-Span-53" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-55" style="vertical-align: -0.222em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-56" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-57" style="font-family: STIXGeneral-Italic; padding-left: 0.228em;">α</span><span class="mo" id="MathJax-Span-58" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mo" id="MathJax-Span-61" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-62" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="texatom" id="MathJax-Span-63"><span class="mrow" id="MathJax-Span-64"><span class="mo" id="MathJax-Span-65" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mo" id="MathJax-Span-66" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">+</span><span class="mn" id="MathJax-Span-67" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">1</span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1000em 1.242em -999.997em); top: -1.292em; left: 0.003em;"><span style="border-left-width: 12.841em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-69" style="font-family: STIXGeneral-Regular;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.931em 1000em 4.226em -999.997em); top: -3.995em; left: 18.922em;"><span style="display: inline-block; position: relative; width: 4.226em; height: 0px;"><span style="position: absolute; clip: rect(3.1em 1000em 4.395em -999.997em); top: -4.164em; right: 0.003em;"><span class="mtd" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-73" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral-Regular;">⟨</span><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-family: STIXGeneral-Regular;">U</span><span class="mi" id="MathJax-Span-78" style="font-family: STIXGeneral-Regular;">N</span><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral-Regular;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-80" style="font-family: STIXGeneral-Regular;">⟩</span><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.537em 1000em 5.183em -999.997em); top: -3.995em; left: 23.145em;"><span style="display: inline-block; position: relative; width: 14.474em; height: 0px;"><span style="position: absolute; clip: rect(2.706em 1000em 5.408em -999.997em); top: -4.164em; left: 0.003em;"><span class="mtd" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84"></span><span class="mo" id="MathJax-Span-85" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">=</span><span class="mfrac" id="MathJax-Span-86" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 12.841em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000em 4.169em -999.997em); top: -4.671em; left: 50%; margin-left: -0.279em;"><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.987em 1000em 4.507em -999.997em); top: -3.15em; left: 50%; margin-left: -6.36em;"><span class="mrow" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mo" id="MathJax-Span-90" style="vertical-align: -0.222em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="munderover" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 2.649em; height: 0px;"><span style="position: absolute; clip: rect(3.043em 1000em 4.451em -999.997em); top: -3.995em; left: 0.003em;"><span class="mo" id="MathJax-Span-92" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.713em; left: 0.904em;"><span class="texatom" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span class="msup" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px;"><span style="position: absolute; clip: rect(3.494em 1000em 4.169em -999.997em); top: -3.995em; left: 0.003em;"><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.22em; left: 0.453em;"><span class="mo" id="MathJax-Span-97" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-98" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="texatom" id="MathJax-Span-100" style="padding-left: 0.172em;"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral-Regular;">c</span><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular;">o</span><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral-Regular;">u</span><span class="mi" id="MathJax-Span-105" style="font-family: STIXGeneral-Regular;">n</span><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Regular;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000em 4.169em -999.997em); top: -3.995em; left: 0.003em;"><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.276em; left: 0.678em;"><span class="mo" id="MathJax-Span-110" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-111" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-112" style="vertical-align: -0.222em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-113" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-114" style="font-family: STIXGeneral-Italic; padding-left: 0.228em;">α</span><span class="mo" id="MathJax-Span-115" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mo" id="MathJax-Span-118" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="texatom" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="mo" id="MathJax-Span-122" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">+</span><span class="mn" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">1</span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1000em 1.242em -999.997em); top: -1.292em; left: 0.003em;"><span style="border-left-width: 12.841em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.142em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.003em; vertical-align: -1.184em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\begin{align*}
                            P(w) &= \frac{\mathrm{count}(w) + \alpha}{\left( \sum_{w' \in V} \mathrm{count}(w') \right) + \alpha (|V| + 1)} ,
                            & P(\langle \mathrm{UNK} \rangle) &= \frac{\alpha}{\left( \sum_{w' \in V} \mathrm{count}(w') \right) + \alpha (|V| + 1)}
                            \end{align*}</script>
                            where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame"><nobr><span class="math" id="MathJax-Span-126" role="math" style="width: 0.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000em 2.706em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-127"><span class="mi" id="MathJax-Span-128" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.628em; vertical-align: -0.059em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">w</script> is a word in the vocabulary <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-129" role="math" style="width: 0.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.706em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-130"><span class="mi" id="MathJax-Span-131" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.878em; vertical-align: -0.059em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">V</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-132" role="math" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000em 2.706em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-133"><span class="mi" id="MathJax-Span-134" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.628em; vertical-align: -0.059em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">\alpha</script> is the smoothing constant (typically in the range <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame"><nobr><span class="math" id="MathJax-Span-135" role="math" style="width: 4.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.282em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.818em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-136"><span class="mn" id="MathJax-Span-137" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-138" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">&lt;</span><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral-Italic; padding-left: 0.341em;">α</span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">≤</span><span class="mn" id="MathJax-Span-141" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.003em; vertical-align: -0.184em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">0 \lt \alpha \le 1</script>), and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame"><nobr><span class="math" id="MathJax-Span-142" role="math" style="width: 3.325em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.987em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.636em 1000em 2.931em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-143"><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral-Regular;">⟨</span><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-family: STIXGeneral-Regular;">U</span><span class="mi" id="MathJax-Span-148" style="font-family: STIXGeneral-Regular;">N</span><span class="mi" id="MathJax-Span-149" style="font-family: STIXGeneral-Regular;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.128em; vertical-align: -0.309em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\langle \mathrm{UNK} \rangle</script> denotes a special word that will be substituted for unknown tokens at test time.
                        </p>
                        <table class="codeGroup">
                            <tbody><tr>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> paths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"data/train/ham/ham%d"</span> <span class="token operator">%</span> i
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>          <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p <span class="token operator">=</span> log_probs<span class="token punctuation">(</span>paths<span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">[</span><span class="token string">"the"</span><span class="token punctuation">]</span>
<span class="token operator">-</span><span class="token number">3.6080194731874062</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">[</span><span class="token string">"line"</span><span class="token punctuation">]</span>
<span class="token operator">-</span><span class="token number">4.272995709320345</span>
</code></pre>
                                </td>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> paths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"data/train/spam/spam%d"</span> <span class="token operator">%</span> i
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>          <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p <span class="token operator">=</span> log_probs<span class="token punctuation">(</span>paths<span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">[</span><span class="token string">"Credit"</span><span class="token punctuation">]</span>
<span class="token operator">-</span><span class="token number">5.837004641921745</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">[</span><span class="token string">"&lt;UNK&gt;"</span><span class="token punctuation">]</span>
<span class="token operator">-</span><span class="token number">20.34566288044584</span>
</code></pre>
                                </td>
                            </tr>
                        </tbody></table>
                    </li>
                    <li>
                        <p><span class="points" data-value="10"></span>Write an initialization method <code class=" language-python">__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> spam_dir<span class="token punctuation">,</span> ham_dir<span class="token punctuation">,</span> smoothing<span class="token punctuation">)</span></code> in the <code class=" language-python">SpamFilter</code> class that creates two log-probability dictionaries corresponding to the emails in the provided spam and ham directories, then stores them internally for future use. Also compute the class probabilities <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-151" role="math" style="width: 3.832em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.437em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.931em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-154" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: STIXGeneral-Regular;">s</span><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral-Regular;">p</span><span class="mi" id="MathJax-Span-159" style="font-family: STIXGeneral-Regular;">a</span><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral-Regular;">m</span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.128em; vertical-align: -0.309em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">P(\mathrm{spam})</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame"><nobr><span class="math" id="MathJax-Span-162" role="math" style="width: 4.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.001em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.931em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-165" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral-Regular;">¬</span><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: STIXGeneral-Regular;">s</span><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral-Regular;">p</span><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral-Regular;">a</span><span class="mi" id="MathJax-Span-172" style="font-family: STIXGeneral-Regular;">m</span></span></span><span class="mo" id="MathJax-Span-173" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.128em; vertical-align: -0.309em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">P(\neg \mathrm{spam})</script> based on the number of files in the input directories.</p>
                    </li>
                    <li>
                        <p><span class="points" data-value="25"></span>Write a method <code class=" language-python">is_spam<span class="token punctuation">(</span>self<span class="token punctuation">,</span> email_path<span class="token punctuation">)</span></code> in the <code class=" language-python">SpamFilter</code> class that returns a Boolean value indicating whether the email at the given file path is predicted to be spam. Tokens which were not encountered during the training process should be converted into the special word <code class=" language-python"><span class="token string">"&lt;UNK&gt;"</span></code> in order to avoid zero probabilities.</p>
                        <p>Recall from the lecture slides that for a given class <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-174" role="math" style="width: 8.899em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.998em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.931em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-177" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">∈</span><span class="mo" id="MathJax-Span-178" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">{</span><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: STIXGeneral-Regular;">s</span><span class="mi" id="MathJax-Span-182" style="font-family: STIXGeneral-Regular;">p</span><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral-Regular;">a</span><span class="mi" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">m</span></span></span><span class="mo" id="MathJax-Span-185" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral-Regular; padding-left: 0.172em;">¬</span><span class="texatom" id="MathJax-Span-187"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral-Regular;">s</span><span class="mi" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular;">p</span><span class="mi" id="MathJax-Span-191" style="font-family: STIXGeneral-Regular;">a</span><span class="mi" id="MathJax-Span-192" style="font-family: STIXGeneral-Regular;">m</span></span></span><span class="mo" id="MathJax-Span-193" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.128em; vertical-align: -0.309em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">c \in \{ \mathrm{spam}, \neg \mathrm{spam} \}</script>,
                            <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame"><nobr><span class="math" id="MathJax-Span-194" role="math" style="width: 19.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.021em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.622em 1000em 3.156em -999.997em); top: -2.137em; left: 0.003em;"><span class="mrow" id="MathJax-Span-195"><span class="mtable" id="MathJax-Span-196" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 17.683em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1000em 5.014em -999.997em); top: -3.995em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 17.683em; height: 0px;"><span style="position: absolute; clip: rect(2.874em 1000em 5.465em -999.997em); top: -4.389em; right: 0.003em;"><span class="mtd" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-200" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-201" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-202" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">∣</span><span class="texatom" id="MathJax-Span-203" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-family: STIXGeneral-Regular;">d</span><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Regular;">o</span><span class="mi" id="MathJax-Span-207" style="font-family: STIXGeneral-Regular;">c</span><span class="mi" id="MathJax-Span-208" style="font-family: STIXGeneral-Regular;">u</span><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral-Regular;">m</span><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral-Regular;">e</span><span class="mi" id="MathJax-Span-211" style="font-family: STIXGeneral-Regular;">n</span><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral-Regular;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-213" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-214" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">∼</span><span class="mi" id="MathJax-Span-215" style="font-family: STIXGeneral-Italic; padding-left: 0.341em;">P</span><span class="mo" id="MathJax-Span-216" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-217" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-218" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-219" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px;"><span style="position: absolute; clip: rect(2.874em 1000em 4.62em -999.997em); top: -3.995em; left: 0.059em;"><span class="mo" id="MathJax-Span-220" style="font-family: STIXSizeOneSym; vertical-align: -0.504em;">∏</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000em 4.282em -999.997em); top: -2.869em; left: 0.003em;"><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-224" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-226" style="font-family: STIXGeneral-Italic; padding-left: 0.172em;">P</span><span class="mo" id="MathJax-Span-227" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-229" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">∣</span><span class="mi" id="MathJax-Span-230" style="font-family: STIXGeneral-Italic; padding-left: 0.341em;">c</span><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 2.931em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000em 4.338em -999.997em); top: -3.995em; left: 0.003em;"><span class="mo" id="MathJax-Span-232" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.389em; left: 0.341em;"><span class="texatom" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">c</span><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">o</span><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">u</span><span class="mi" id="MathJax-Span-240" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">n</span><span class="mi" id="MathJax-Span-241" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-242" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-245" style="font-family: STIXGeneral-Regular;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.142em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.628em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">\begin{align*}
                            P(c \mid \mathrm{document}) \sim P(c) \prod_{w \in V} P(w \mid c)^{\mathrm{count}(w)}
                            ,
                            \end{align*}</script>
                            where the normalization constant <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame"><nobr><span class="math" id="MathJax-Span-246" role="math" style="width: 6.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.028em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000em 2.874em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-247"><span class="mn" id="MathJax-Span-248" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-249"><span class="mrow" id="MathJax-Span-250"><span class="mo" id="MathJax-Span-251" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-252" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-253" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-254"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-family: STIXGeneral-Regular;">d</span><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Regular;">o</span><span class="mi" id="MathJax-Span-258" style="font-family: STIXGeneral-Regular;">c</span><span class="mi" id="MathJax-Span-259" style="font-family: STIXGeneral-Regular;">u</span><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral-Regular;">m</span><span class="mi" id="MathJax-Span-261" style="font-family: STIXGeneral-Regular;">e</span><span class="mi" id="MathJax-Span-262" style="font-family: STIXGeneral-Regular;">n</span><span class="mi" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">1 / P(\mathrm{document})</script> is the same for both classes and can therefore be ignored. Here, the count of a word is computed over the input document to be classified.
                        </p>
                        <p>Remember that these computations should be computed in log-space to avoid underflow.</p>
                        <table class="codeGroup">
                            <tbody><tr>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf <span class="token operator">=</span> SpamFilter<span class="token punctuation">(</span><span class="token string">"data/train/spam"</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">"data/train/ham"</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf<span class="token punctuation">.</span>is_spam<span class="token punctuation">(</span><span class="token string">"data/train/spam/spam1"</span><span class="token punctuation">)</span>
<span class="token boolean">True</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf<span class="token punctuation">.</span>is_spam<span class="token punctuation">(</span><span class="token string">"data/train/spam/spam2"</span><span class="token punctuation">)</span>
<span class="token boolean">True</span>
</code></pre>
                                </td>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf <span class="token operator">=</span> SpamFilter<span class="token punctuation">(</span><span class="token string">"data/train/spam"</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">"data/train/ham"</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf<span class="token punctuation">.</span>is_spam<span class="token punctuation">(</span><span class="token string">"data/train/ham/ham1"</span><span class="token punctuation">)</span>
<span class="token boolean">False</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf<span class="token punctuation">.</span>is_spam<span class="token punctuation">(</span><span class="token string">"data/train/ham/ham2"</span><span class="token punctuation">)</span>
<span class="token boolean">False</span>
</code></pre>
                                </td>
                            </tr>
                        </tbody></table>
                    </li>
                    <li>
                        <p><span class="points" data-value="15"></span>Suppose we define the spam indication value of a word <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame"><nobr><span class="math" id="MathJax-Span-265" role="math" style="width: 0.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000em 2.706em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.628em; vertical-align: -0.059em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">w</script> to be the quantity
                            <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-268" role="math" style="width: 9.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.505em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.199em 1000em 4.789em -999.997em); top: -3.77em; left: 0.003em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: STIXGeneral-Regular;">log</span><span class="mrow" id="MathJax-Span-271" style="padding-left: 0.172em;"><span class="mo" id="MathJax-Span-272" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mfrac" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 5.127em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1000em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -2.475em;"><span class="mrow" id="MathJax-Span-274"><span class="mi" id="MathJax-Span-275" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-277" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-278" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">∣</span><span class="texatom" id="MathJax-Span-279" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-family: STIXGeneral-Regular;">s</span><span class="mi" id="MathJax-Span-282" style="font-family: STIXGeneral-Regular;">p</span><span class="mi" id="MathJax-Span-283" style="font-family: STIXGeneral-Regular;">a</span><span class="mi" id="MathJax-Span-284" style="font-family: STIXGeneral-Regular;">m</span></span></span><span class="mo" id="MathJax-Span-285" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -0.954em;"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-288" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-289" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-290" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1000em 1.242em -999.997em); top: -1.292em; left: 0.003em;"><span style="border-left-width: 5.127em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-291" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span class="mo" id="MathJax-Span-292" style="font-family: STIXGeneral-Regular; padding-left: 0.172em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.775em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.628em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">
                            \log \left( \frac{P(w \mid \mathrm{spam})}{P(w)} \right)
                            .
                            </script>
                            Similarly, define the ham indication value of a word <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame"><nobr><span class="math" id="MathJax-Span-293" role="math" style="width: 0.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000em 2.706em -999.997em); top: -2.531em; left: 0.003em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.628em; vertical-align: -0.059em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">w</script> to be
                            <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame"><nobr><span class="math" id="MathJax-Span-296" role="math" style="width: 10.194em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.181em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.199em 1000em 4.789em -999.997em); top: -3.77em; left: 0.003em;"><span class="mrow" id="MathJax-Span-297"><span class="mi" id="MathJax-Span-298" style="font-family: STIXGeneral-Regular;">log</span><span class="mrow" id="MathJax-Span-299" style="padding-left: 0.172em;"><span class="mo" id="MathJax-Span-300" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mfrac" id="MathJax-Span-301"><span style="display: inline-block; position: relative; width: 5.746em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1000em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -2.813em;"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-304" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-305" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-306" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">∣</span><span class="mi" id="MathJax-Span-307" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">¬</span><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: STIXGeneral-Regular;">s</span><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral-Regular;">p</span><span class="mi" id="MathJax-Span-312" style="font-family: STIXGeneral-Regular;">a</span><span class="mi" id="MathJax-Span-313" style="font-family: STIXGeneral-Regular;">m</span></span></span><span class="mo" id="MathJax-Span-314" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -0.954em;"><span class="mrow" id="MathJax-Span-315"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-317" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-318" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-319" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1000em 1.242em -999.997em); top: -1.292em; left: 0.003em;"><span style="border-left-width: 5.746em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-320" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span class="mo" id="MathJax-Span-321" style="font-family: STIXGeneral-Regular; padding-left: 0.172em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.775em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.628em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">
                            \log \left( \frac{P(w \mid \neg \mathrm{spam})}{P(w)} \right)
                            .
                            </script>
                        </p>
                        <p>Write a pair of methods <code class=" language-python">most_indicative_spam<span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">)</span></code> and <code class=" language-python">most_indicative_ham<span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">)</span></code> in the <code class=" language-python">SpamFilter</code> class which return the <code class=" language-python">n</code> most indicative words for each category, sorted in descending order based on their indication values. You should restrict the set of words considered for each method to those which appear in at least one spam email and one ham email. <span class="hint">The probabilities computed within the <code class=" language-python">__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> spam_dir<span class="token punctuation">,</span> ham_dir<span class="token punctuation">,</span> smoothing<span class="token punctuation">)</span></code> method are sufficient to calculate these quantities.</span></p>
                        <table class="codeGroup">
                            <tbody><tr>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf <span class="token operator">=</span> SpamFilter<span class="token punctuation">(</span><span class="token string">"data/train/spam"</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">"data/train/ham"</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf<span class="token punctuation">.</span>most_indicative_spam<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'&lt;a'</span><span class="token punctuation">,</span> <span class="token string">'&lt;input'</span><span class="token punctuation">,</span> <span class="token string">'&lt;html&gt;'</span><span class="token punctuation">,</span> <span class="token string">'&lt;meta'</span><span class="token punctuation">,</span>
 <span class="token string">'&lt;/head&gt;'</span><span class="token punctuation">]</span>
</code></pre>
                                </td>
                                <td>
                                    <pre class=" language-python"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf <span class="token operator">=</span> SpamFilter<span class="token punctuation">(</span><span class="token string">"data/train/spam"</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">"data/train/ham"</span><span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> sf<span class="token punctuation">.</span>most_indicative_ham<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'Aug'</span><span class="token punctuation">,</span> <span class="token string">'ilug@linux.ie'</span><span class="token punctuation">,</span> <span class="token string">'install'</span><span class="token punctuation">,</span>
 <span class="token string">'spam.'</span><span class="token punctuation">,</span> <span class="token string">'Group:'</span><span class="token punctuation">]</span>
</code></pre>
                                </td>
                            </tr>
                        </tbody></table>
                    </li>
                </ol>
            </section>
            <section class="numbered">
                <h3>Feedback<span class="points" data-value="5"></span></h3>
                <ol>
                    <li>
                        <p><span class="points" data-value="1"></span>Approximately how long did you spend on this assignment?</p>
                    </li>
                    <li>
                        <p><span class="points" data-value="2"></span>Which aspects of this assignment did you find most challenging? Were there any significant stumbling blocks?</p>
                    </li>
                    <li>
                        <p><span class="points" data-value="2"></span>Which aspects of this assignment did you like? Is there anything you would have changed?</p>
                    </li>
                </ol>
            </section>
        </div>
    

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>